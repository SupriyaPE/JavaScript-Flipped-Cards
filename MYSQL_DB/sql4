CREATE TABLE Customer (
  Customer_id NUMERIC(5) PRIMARY KEY
);

INSERT INTO Customer(Customer_id) 
VALUES
(10),
(20),
(30),
(40),
(50);



CREATE TABLE Emp (
  emp_id NUMERIC(5) PRIMARY KEY,
  emp_firstname VARCHAR(50) NOT NULL,
  emp_lastname VARCHAR(50) NOT NULL,
  salary NUMERIC(10,2),      
  Customer_id NUMERIC(5),
  FOREIGN KEY (Customer_id) REFERENCES Customer(Customer_id)
);

INSERT INTO Emp (emp_id, emp_firstname, emp_lastname, salary, Customer_id)
VALUES
(1, 'ALLEN', 'A', 50000.00, 10),
(2, 'BLAKE', 'B', 70000.00, 20),
(3, 'CLARK', 'C', 60000.00, 30),
(4, 'MILLER', 'D', 40000.00, 40),
(5, 'SMITH', 'E', 90000.00, 50);


ALTER TABLE Emp 
add email varchar(15) unique;

ALTER TABLE Emp 
Drop coloumn email varchar(15) unique;

ALTER TABLE Emp 
rename coloumn email to email_id;

ALTER TABLE Emp 
modify email varchar(20) unique;


TRUNCATE TABLE Emp;

DROP TABLE Emp;


-- subquery operators
-- all
-- any
-- EXISTS
-- not EXISTS


select sal,ename
from emp
where sal > all(select sal 
                from emp
                where dept no=10)
                

select sal,ename
from emp
where sal > any(select sal 
                from emp
                where dept no=10)

 
SELECT *
FROM Customers c
WHERE EXISTS (
    SELECT 1
    FROM Orders o
    WHERE o.customer_id = c.id
);


SELECT *
FROM Customers c
WHERE NOT EXISTS (
    SELECT 1
    FROM Orders o
    WHERE o.customer_id = c.id
);

-- Ranking

-- Rownumber()
-- Rank()
-- Dence_Rank()

SELECT 
  student_name,
  score,
  ROW_NUMBER() OVER (ORDER BY score DESC) AS row_num
FROM Students;

SELECT 
  student_name,
  score,
  RANK() OVER (ORDER BY score DESC) AS rank_no
FROM Students;


SELECT 
  student_name,
  score,
  RANK() OVER (ORDER BY score DESC) AS rank_no DENSE_RANK() OVER (ORDER BY score DESC) AS dense_rank_no
FROM Students;

SELECT 
  student_name,
  score,
  DENSE_RANK() OVER (ORDER BY score DESC) AS dense_rank_no
FROM Students;